<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>FIELD TERMINAL (FINAL v2)</title>
    <style>
        :root {
            --bg-color: #000000;
            --text-main: #e0e0e0;
            --highlight: #00ff41;
            --danger: #ff3333;
            --warning: #ffcc00;
            --cool: #00ffff;
            --panel-bg: #111111;
            --border: #333;
            --alpha: #ff3333;
            --bravo: #33cc33;
            --charlie: #3388ff;
            --delta: #ffff33;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-variant-numeric: slashed-zero;
            margin: 0;
            height: 100dvh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .hidden { display: none !important; }
        
        /* ÈÄöÁî®Ëû¢ÂπïÂÆπÂô® */
        .screen { 
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
            padding: 20px; padding-top: 5vh; width: 100%; height: 100%; position: absolute; top: 0; left: 0;
            background: #000; z-index: 10; overflow-y: auto;
        }

        h1, h2 { text-transform: uppercase; letter-spacing: 2px; text-align: center; margin-bottom: 20px; color: var(--highlight); }
        h2 { font-size: 1.2rem; margin-bottom: 15px; }

        /* --- Êñ∞ÁâàÈ¶ñÈ†ÅÔºöÂ∞èÈöäÈÅ∏ÊìáÈÅ∏ÂñÆ --- */
        #squad-menu { z-index: 5; justify-content: center; padding-top: 20px; }
        .menu-btn {
            width: 100%; max-width: 320px; padding: 25px; margin-bottom: 20px;
            font-size: 1.5rem; font-weight: 900; border-radius: 12px;
            background: #111; color: #fff; border: 3px solid #333;
            text-align: left; position: relative; cursor: pointer; transition: 0.2s;
            display: flex; justify-content: space-between; align-items: center;
        }
        .menu-btn:active { transform: scale(0.97); filter: brightness(1.2); }
        .menu-btn::after { content: 'üìì'; font-size: 1.8rem; }

        /* --- Êñ∞ÁâàÈ†ÅÈù¢ÔºöÂØÜÁ¢ºÊú¨Ê™¢Ë¶ñ --- */
        #codebook-view { z-index: 6; background: #050505; }
        .book-header { 
            width: 100%; padding: 15px; text-align: center; font-size: 1.5rem; font-weight: 900; 
            color: #fff; margin-bottom: 20px; border-radius: 8px; text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
        }
        
        .book-category-title {
            width: 100%; max-width: 350px;
            color: #666; font-size: 0.8rem; margin-top: 15px; margin-bottom: 5px; border-bottom: 1px solid #333; padding-bottom: 2px;
        }

        .book-grid {
            display: grid; grid-template-columns: 1fr auto; gap: 8px;
            width: 100%; max-width: 350px; margin-bottom: 10px;
        }
        
        .book-item-col {
            display: flex; align-items: center; padding: 10px;
            background: rgba(255,255,255,0.05); border-radius: 6px 0 0 6px; font-size: 1rem;
        }
        .book-icon { font-size: 1.5rem; margin-right: 12px; }

        .book-code-col {
            display: flex; align-items: center; justify-content: center; padding: 10px; min-width: 100px;
            background: rgba(0,0,0,0.3); border: 1px solid var(--highlight); border-radius: 0 6px 6px 0;
            font-family: 'Consolas', monospace; font-size: 1.2rem; font-weight: 900; color: var(--highlight); letter-spacing: 1px;
        }

        .back-btn { margin-top: 30px; margin-bottom: 30px; background: #333; color: #ccc; border: none; }

        /* --- ‰ªªÂãô‰ªãÈù¢ÂÖÉ‰ª∂ --- */
        .input-box {
            background: #000; border: 2px solid var(--highlight); color: var(--highlight);
            font-size: 2rem; padding: 15px; width: 100%; max-width: 300px; text-align: center;
            border-radius: 8px; margin-bottom: 20px; outline: none; font-family: inherit; text-transform: uppercase; user-select: text;
        }
        .btn {
            background: var(--panel-bg); border: 1px solid var(--highlight); color: var(--highlight);
            padding: 15px 30px; font-size: 1.2rem; border-radius: 8px; cursor: pointer;
            text-transform: uppercase; font-weight: bold; width: 100%; max-width: 300px; margin-bottom: 15px; transition: all 0.2s; flex-shrink: 0; 
        }
        .btn:active { background: var(--highlight); color: #000; transform: scale(0.98); }
        
        /* --- ‰ªªÂãôÁãÄÊÖãÁï´Èù¢ --- */
        .target-icon { font-size: 6rem; margin-bottom: 10px; animation: pulse 2s infinite; }
        @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
        .mission-hint { color: #888; font-size: 0.9rem; text-align: center; margin-bottom: 30px; max-width: 80%; }
        
        /* SUCCESS SCREEN */
        #screen-success { background: #001a00; z-index: 20; text-align: center; padding-top: 5vh; }
        .success-icon { font-size: 5rem; color: var(--highlight); margin-bottom: 20px; }
        .success-title { color: var(--highlight); font-size: 1.5rem; font-weight: bold; margin-bottom: 20px; }
        .next-step-box { border: 1px dashed var(--highlight); padding: 15px; border-radius: 8px; background: rgba(0, 255, 65, 0.1); margin-bottom: 10px; width: 100%; max-width: 320px; }
        .step-label { color: #888; font-size: 0.8rem; display: block; margin-bottom: 5px; }
        .step-val { color: #fff; font-size: 1.1rem; font-weight: bold; display: block; line-height: 1.4; }
        .comm-val { color: #ffcc00; font-size: 1rem; font-weight: bold; display: block; line-height: 1.4; white-space: pre-line; }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        
    </style>
</head>
<body>

    <div id="squad-menu" class="screen">
        <h1>CODE BOOK ACCESS</h1>
        <p style="color:#666; margin-bottom:30px;">OFFLINE DATABASE</p>
        <p style="color:#888; font-size:0.8rem; margin-bottom:20px;">Ë´ãÈÅ∏ÊìáÊÇ®ÊâÄÂ±¨ÁöÑÂ∞èÈöä‰ª•Êü•ÁúãÂØÜÁ¢ºÊú¨</p>
        
        <div class="menu-btn" style="border-color:var(--alpha); color:var(--alpha);" onclick="showCodeBook('A')">ALPHA SQUAD</div>
        <div class="menu-btn" style="border-color:var(--bravo); color:var(--bravo);" onclick="showCodeBook('B')">BRAVO SQUAD</div>
        <div class="menu-btn" style="border-color:var(--charlie); color:var(--charlie);" onclick="showCodeBook('C')">CHARLIE SQUAD</div>
        <div class="menu-btn" style="border-color:var(--delta); color:var(--delta);" onclick="showCodeBook('D')">DELTA SQUAD</div>
    </div>

    <div id="codebook-view" class="screen hidden">
        <div id="book-header" class="book-header">SQUAD BOOK</div>
        <p style="color:#666; font-size:0.8rem; margin-bottom:20px;">CONFIDENTIAL // EYES ONLY</p>
        
        <div id="book-content-area" style="width:100%; display:flex; flex-direction:column; align-items:center;"></div>

        <button class="btn back-btn" onclick="showScreen('squad-menu')">‚Üê BACK TO MENU</button>
    </div>

    <div id="screen-mission" class="screen hidden">
        <div style="text-align:right; width:100%; padding:10px; color:#444; font-size:0.8rem;">SECURE CONNECTION</div>
        <div id="target-display" class="target-icon">‚ùì</div>
        <div id="target-name" style="font-size:1.5rem; font-weight:bold; margin-bottom:5px;">TARGET</div>
        <p class="mission-hint">ÂêëÂèãËªçÂñÆ‰ΩçÁ¥¢ÂèñËß£Èéñ‰ª£Á¢º<br>REQUEST CODE FROM ALLY</p>
        <input type="text" id="mission-input" class="input-box" placeholder="CODE" maxlength="10">
        <button class="btn" onclick="verifyCode()">VERIFY CODE</button>
    </div>

    <div id="screen-success" class="screen hidden">
        <div class="success-icon">‚úÖ</div>
        <div class="success-title">ACCESS GRANTED</div>
        <div class="next-step-box">
            <span class="step-label">NEXT LOCATION (‰∏ã‰∏ÄÁ´ô)</span>
            <span id="success-next-loc" class="step-val">...</span>
        </div>
        <div class="next-step-box">
            <span class="step-label">COMM PROTOCOL (ÈÄöË®äÊåá‰ª§)</span>
            <span id="success-comm-msg" class="comm-val">...</span>
        </div>
        <button class="btn" style="margin-top:30px; border-color:#666; color:#666;" onclick="location.reload()">RELOAD TERMINAL</button>
    </div>

    <script>
        // --- 1. CODEBOOKS DATA (ÂÆåÊï¥Ë≥áÊñôÂ∫´) ---
        const CODEBOOKS = {
            A: {
                fruits: [
                    {n:"Ëë°ËêÑ", i:"üçá", c:"L2Z5"}, {n:"Ë•øÁìú", i:"üçâ", c:"P8K3"}, {n:"Ê©òÂ≠ê", i:"üçä", c:"S4M1"}, {n:"Ê™∏Ê™¨", i:"üçã", c:"T4W7"},
                    {n:"ËòãÊûú", i:"üçé", c:"X4T9"}, {n:"Ê°ÉÂ≠ê", i:"üçë", c:"N8R3"}, {n:"Ê´ªÊ°É", i:"üçí", c:"E9I2"}, {n:"Ê¢®Â≠ê", i:"üçê", c:"Q4Y9"},
                    {n:"Ê§∞Â≠ê", i:"ü••", c:"B1D6"}, {n:"ÈÖ™Ê¢®", i:"ü•ë", c:"H5J0"}, {n:"Á≥ñÊûú", i:"üç¨", c:"F3G8"}, {n:"ËäíÊûú", i:"ü•≠", c:"K7X1"},
                    {n:"ÂìàÂØÜÁìú", i:"üçà", c:"V2C5"}, {n:"Áï™ËåÑ", i:"üçÖ", c:"O6A4"}, {n:"ËçâËéì", i:"üçì", c:"U9E2"}, {n:"È≥≥Ê¢®", i:"üçç", c:"Z3N7"}
                ],
                animals: [
                    {n:"ËÄÅÈ∑π", i:"ü¶Ö", c:"D5S2"}, {n:"Ëõá", i:"üêç", c:"W9F0"}, {n:"ÈØäÈ≠ö", i:"ü¶à", c:"H1J3"}, {n:"ÊñëÈ¶¨", i:"ü¶ì", c:"O3A0"},
                    {n:"ÈØ®È≠ö", i:"üê≥", c:"V2D6"}, {n:"ÁçµË±π", i:"üêÜ", c:"K8B4"}, {n:"ÁçÖÂ≠ê", i:"ü¶Å", c:"C7M1"}, {n:"Ë¢ãÈº†", i:"ü¶ò", c:"G6P9"},
                    {n:"È±∑È≠ö", i:"üêä", c:"X2U5"}, {n:"Â§ßÁå©Áå©", i:"ü¶ç", c:"T1I8"}, {n:"Ê≤≥È¶¨", i:"ü¶õ", c:"E4Z7"}, {n:"Èï∑È†∏Èπø", i:"ü¶í", c:"N3Y0"},
                    {n:"ËùôËù†", i:"ü¶á", c:"Q5L2"}, {n:"Ë≤ìÈ†≠È∑π", i:"ü¶â", c:"R9S6"}, {n:"Èß±Èßù", i:"üê™", c:"M7H3"}, {n:"Â≠îÈõÄ", i:"ü¶ö", c:"A0F1"}
                ],
                plants: [
                    {n:"ÂêëÊó•Ëëµ", i:"üåª", c:"G2V4"}, {n:"‰ªô‰∫∫Êéå", i:"üåµ", c:"B8H7"}, {n:"Á´πÂ≠ê", i:"üéã", c:"L6P2"}, {n:"ËòëËèá", i:"üçÑ", c:"S8M2"},
                    {n:"Êâ∂Ê°ëËä±", i:"üå∫", c:"F5G8"}, {n:"Ê©°Ê®π", i:"üå≥", c:"T1Q9"}, {n:"Ê•ìËëâ", i:"üçÅ", c:"Z7D5"}, {n:"Ëñ∞Ë°£Ëçâ", i:"üíê", c:"K3I6"},
                    {n:"ËñÑËç∑", i:"üåø", c:"E2A4"}, {n:"ÊùæÊ®π", i:"üå≤", c:"J3R6"}, {n:"Â∞èÈ∫•", i:"üåæ", c:"Y9X1"}, {n:"ËòÜËë¶", i:"üå±", c:"O5N0"},
                    {n:"ËêΩËëâ", i:"üçÇ", c:"H4W8"}, {n:"ÈõõËèä", i:"üåº", c:"C6U3"}, {n:"ÊàøÂ±ã", i:"üè°", c:"V0S7"}, {n:"Ë≤ùÊÆº", i:"üêö", c:"P8M5"}
                ]
            },
            B: {
                fruits: [
                    {n:"È¶ôËïâ", i:"üçå", c:"A3O7"}, {n:"È≥≥Ê¢®", i:"üçç", c:"U6Q4"}, {n:"Ê¢®Â≠ê", i:"üçê", c:"B2H9"}, {n:"ËòãÊûú", i:"üçé", c:"C5K1"},
                    {n:"Ë•øÁìú", i:"üçâ", c:"D8M3"}, {n:"Á≥ñÊûú", i:"üç¨", c:"E0N6"}, {n:"Â•áÁï∞Êûú", i:"ü•ù", c:"F4P2"}, {n:"ËçâËéì", i:"üçì", c:"G7Q5"},
                    {n:"Ê§∞Â≠ê", i:"ü••", c:"I1R8"}, {n:"ËäíÊûú", i:"ü•≠", c:"J9S0"}, {n:"Ëë°ËêÑ", i:"üçá", c:"L3T6"}, {n:"Ê´ªÊ°É", i:"üçí", c:"V2X7"},
                    {n:"Ê™∏Ê™¨", i:"üçã", c:"W5Y3"}, {n:"Ê©òÂ≠ê", i:"üçä", c:"Z8A4"}, {n:"Áï™ËåÑ", i:"üçÖ", c:"B6C9"}, {n:"ÂìàÂØÜÁìú", i:"üçà", c:"D1E5"}
                ],
                animals: [
                    {n:"ËÄÅËôé", i:"üêØ", c:"Y5N8"}, {n:"Â§ßË±°", i:"üêò", c:"S2K9"}, {n:"ÁçµË±π", i:"üêÜ", c:"F7G1"}, {n:"Áãº", i:"üê∫", c:"H3I6"},
                    {n:"ÁÜä", i:"üêª", c:"J0L4"}, {n:"ÁãêÁã∏", i:"ü¶ä", c:"M8O2"}, {n:"ÁçÖÂ≠ê", i:"ü¶Å", c:"P5Q9"}, {n:"ÊñëÈ¶¨", i:"ü¶ì", c:"R1T7"},
                    {n:"Ë¢ãÈº†", i:"ü¶ò", c:"U4V0"}, {n:"Èï∑È†∏Èπø", i:"ü¶í", c:"W6X3"}, {n:"ÈØäÈ≠ö", i:"ü¶à", c:"Z9A5"}, {n:"ËÄÅÈ∑π", i:"ü¶Ö", c:"B2C8"},
                    {n:"Ë≤ìÈ†≠È∑π", i:"ü¶â", c:"D7E1"}, {n:"Ëõá", i:"üêç", c:"F3G6"}, {n:"È±∑È≠ö", i:"üêä", c:"H9I2"}, {n:"ÁÜäË≤ì", i:"üêº", c:"K4L0"}
                ],
                plants: [
                    {n:"Áé´Áë∞", i:"üåπ", c:"M4X0"}, {n:"Ê•ìËëâ", i:"üçÅ", c:"Z7D5"}, {n:"Ê§∞Â≠êÊ®π", i:"üå¥", c:"A2B6"}, {n:"Âπ∏ÈÅãËçâ", i:"üçÄ", c:"C9E1"},
                    {n:"ÂêëÊó•Ëëµ", i:"üåª", c:"F3G8"}, {n:"‰ªô‰∫∫Êéå", i:"üåµ", c:"H5I0"}, {n:"È¨±ÈáëÈ¶ô", i:"üå∑", c:"J1K7"}, {n:"Êâ∂Ê°ëËä±", i:"üå∫", c:"L6N3"},
                    {n:"ÊùæÊ®π", i:"üå≤", c:"O8P2"}, {n:"Á®ªÁ©ó", i:"üåæ", c:"Q4R9"}, {n:"ËòëËèá", i:"üçÑ", c:"S0T5"}, {n:"Á´πÂ≠ê", i:"üéã", c:"U7V1"},
                    {n:"ÈõõËèä", i:"üåº", c:"W2Y6"}, {n:"Ëñ∞Ë°£Ëçâ", i:"üíê", c:"Z5A3"}, {n:"ËñÑËç∑", i:"üåø", c:"B9C4"}, {n:"Ë≤ùÊÆº", i:"üêö", c:"D1E8"}
                ]
            },
            C: {
                fruits: [
                    {n:"ËçâËéì", i:"üçì", c:"V1G5"}, {n:"Ê°ÉÂ≠ê", i:"üçë", c:"N8R3"}, {n:"Ê¢®Â≠ê", i:"üçê", c:"A4B7"}, {n:"Ê™∏Ê™¨", i:"üçã", c:"C9D1"},
                    {n:"Ê§∞Â≠ê", i:"ü••", c:"E2F6"}, {n:"Ëë°ËêÑ", i:"üçá", c:"G5H0"}, {n:"ÂìàÂØÜÁìú", i:"üçà", c:"I8J3"}, {n:"Ë•øÁìú", i:"üçâ", c:"K1L9"},
                    {n:"Ê©òÂ≠ê", i:"üçä", c:"M6N4"}, {n:"È≥≥Ê¢®", i:"üçç", c:"O3P7"}, {n:"ËòãÊûú", i:"üçé", c:"Q0R2"}, {n:"È¶ôËïâ", i:"üçå", c:"S5T8"},
                    {n:"ËäíÊûú", i:"ü•≠", c:"U7V9"}, {n:"Áï™ËåÑ", i:"üçÖ", c:"W2X5"}, {n:"Á≥ñÊûú", i:"üç¨", c:"Y6Z1"}, {n:"ÈÖ™Ê¢®", i:"ü•ë", c:"A9B4"}
                ],
                animals: [
                    {n:"Áãº", i:"üê∫", c:"F6B2"}, {n:"ÁÜäË≤ì", i:"üêº", c:"I9E4"}, {n:"ÁçÖÂ≠ê", i:"ü¶Å", c:"C2D8"}, {n:"ËÄÅËôé", i:"üêÖ", c:"G7H1"},
                    {n:"ÊñëÈ¶¨", i:"ü¶ì", c:"J3K5"}, {n:"ËÄÅÈ∑π", i:"ü¶Ö", c:"L0M9"}, {n:"È±∑È≠ö", i:"üêä", c:"N4O6"}, {n:"ÈØäÈ≠ö", i:"ü¶à", c:"P8Q2"},
                    {n:"Â§ßË±°", i:"üêò", c:"R1S7"}, {n:"Ë≤ìÈ†≠È∑π", i:"ü¶â", c:"T5U0"}, {n:"Èï∑È†∏Èπø", i:"ü¶í", c:"V9W3"}, {n:"Ê≤≥È¶¨", i:"ü¶õ", c:"X6Y1"},
                    {n:"Â§ßÁå©Áå©", i:"ü¶ç", c:"Z2A8"}, {n:"ÁãêÁã∏", i:"ü¶ä", c:"B7C3"}, {n:"Ë¢ãÈº†", i:"ü¶ò", c:"D0E5"}, {n:"ÁÜä", i:"üêª", c:"F4G9"}
                ],
                plants: [
                    {n:"È¨±ÈáëÈ¶ô", i:"üå∑", c:"Q7U1"}, {n:"Ê§∞Â≠êÊ®π", i:"üå¥", c:"C5Y9"}, {n:"ËòëËèá", i:"üçÑ", c:"S8M2"}, {n:"Á´πÂ≠ê", i:"üéã", c:"A3B6"},
                    {n:"Ê•ìËëâ", i:"üçÅ", c:"D0E4"}, {n:"ÊùæÊ®π", i:"üå≤", c:"F9G2"}, {n:"Êâ∂Ê°ëËä±", i:"üå∫", c:"H1I5"}, {n:"‰ªô‰∫∫Êéå", i:"üåµ", c:"J6K8"},
                    {n:"ÂêëÊó•Ëëµ", i:"üåª", c:"L2M7"}, {n:"Áé´Áë∞", i:"üåπ", c:"N4O0"}, {n:"Âπ∏ÈÅãËçâ", i:"üçÄ", c:"P8R3"}, {n:"Á®ªÁ©ó", i:"üåæ", c:"S5T9"},
                    {n:"Ëñ∞Ë°£Ëçâ", i:"üíê", c:"V1W6"}, {n:"ÈõõËèä", i:"üåº", c:"X7Z2"}, {n:"ËñÑËç∑", i:"üåø", c:"A9B3"}, {n:"Ë≤ùÊÆº", i:"üêö", c:"C0D5"}
                ]
            },
            D: {
                fruits: [
                    {n:"Â•áÁï∞Êûú", i:"ü•ù", c:"J6H2"}, {n:"Ê¢®Â≠ê", i:"üçê", c:"Q4Y9"}, {n:"ËäíÊûú", i:"ü•≠", c:"K7X1"}, {n:"È¶ôËïâ", i:"üçå", c:"A2B5"},
                    {n:"ËòãÊûú", i:"üçé", c:"C8D0"}, {n:"Ê´ªÊ°É", i:"üçí", c:"E3F9"}, {n:"Ëë°ËêÑ", i:"üçá", c:"G6I4"}, {n:"Ë•øÁìú", i:"üçâ", c:"L1M7"},
                    {n:"ËçâËéì", i:"üçì", c:"N5O2"}, {n:"Ê™∏Ê™¨", i:"üçã", c:"P9R3"}, {n:"È≥≥Ê¢®", i:"üçç", c:"S4T8"}, {n:"ÂìàÂØÜÁìú", i:"üçà", c:"U0V6"},
                    {n:"Ê©òÂ≠ê", i:"üçä", c:"W7Z1"}, {n:"ÈÖ™Ê¢®", i:"ü•ë", c:"A5B9"}, {n:"Ê§∞Â≠ê", i:"ü••", c:"C2D6"}, {n:"Áï™ËåÑ", i:"üçÖ", c:"E8F3"}
                ],
                animals: [
                    {n:"ÁÜä", i:"üêª", c:"R3Z5"}, {n:"ÁãêÁã∏", i:"ü¶ä", c:"L8P0"}, {n:"ÈØ®È≠ö", i:"üê≥", c:"V2D6"}, {n:"ËÄÅËôé", i:"üêØ", c:"A7B1"},
                    {n:"ÁçÖÂ≠ê", i:"ü¶Å", c:"C9E4"}, {n:"Áãº", i:"üê∫", c:"F5G8"}, {n:"Â§ßË±°", i:"üêò", c:"H2I6"}, {n:"Â§ßÁå©Áå©", i:"ü¶ç", c:"J0K3"},
                    {n:"È±∑È≠ö", i:"üêä", c:"M4N9"}, {n:"ÁçµË±π", i:"üêÜ", c:"O6Q2"}, {n:"Èï∑È†∏Èπø", i:"ü¶í", c:"S1T7"}, {n:"ËÄÅÈ∑π", i:"ü¶Ö", c:"U8V3"},
                    {n:"Ë≤ìÈ†≠È∑π", i:"ü¶â", c:"W5X0"}, {n:"ËùôËù†", i:"ü¶á", c:"Y9Z4"}, {n:"Ê≤≥È¶¨", i:"ü¶õ", c:"A3B8"}, {n:"Ë¢ãÈº†", i:"ü¶ò", c:"C6D2"}
                ],
                plants: [
                    {n:"Âπ∏ÈÅãËçâ", i:"üçÄ", c:"N9T4"}, {n:"Á®ªÁ©ó", i:"üåæ", c:"W1E3"}, {n:"Êâ∂Ê°ëËä±", i:"üå∫", c:"F5G8"}, {n:"Áé´Áë∞", i:"üåπ", c:"H2I7"},
                    {n:"È¨±ÈáëÈ¶ô", i:"üå∑", c:"J6K0"}, {n:"ÊùæÊ®π", i:"üå≤", c:"L4M9"}, {n:"ÂêëÊó•Ëëµ", i:"üåª", c:"O3P5"}, {n:"‰ªô‰∫∫Êéå", i:"üåµ", c:"Q8R1"},
                    {n:"Á´πÂ≠ê", i:"üéã", c:"S2T6"}, {n:"Ê•ìËëâ", i:"üçÅ", c:"U7V4"}, {n:"Ê§∞Â≠êÊ®π", i:"üå¥", c:"X0Y5"}, {n:"Ëñ∞Ë°£Ëçâ", i:"üíê", c:"Z9A3"},
                    {n:"ÈõõËèä", i:"üåº", c:"B8C2"}, {n:"ËñÑËç∑", i:"üåø", c:"D1E6"}, {n:"Ë≤ùÊÆº", i:"üêö", c:"F5G0"}, {n:"ÊàøÂ±ã", i:"üè°", c:"H4I9"}
                ]
            }
        };

        // --- 2. ‰ªªÂãôË≥áÊñô (Mission Data) ---
        // c Â∑≤Á∂ìÊ†πÊìö‰∏äÊñπ CODEBOOKS ÁöÑË≥áÊñôÈáçÊñ∞Ê†°Â∞çÊõ¥Êñ∞
        const missions = {
            // --- ALPHA SQUAD PATH ---
            'loc_1': { i: 'üçå', n: 'È¶ôËïâ', c: 'A3O7', next: 'ÂâçÂæÄ LOC 5', comm: 'ÂàáÊèõËá≥ [‰∏ªÈ†ª CH2]„ÄÇ\nÂàáÊèõÂæåÔºåË´ãÂëºÂè´Ë©≤È†ªÈÅìÁöÑÂèãËªçÂñÆ‰Ωç„ÄÇ', target_book: 'B' }, 
            'loc_5': { i: 'üê∫', n: 'Áãº', c: 'F6B2', next: 'ÂâçÂæÄ LOC 9', comm: 'ÂàáÊèõËá≥ [‰∏ªÈ†ª CH1]„ÄÇ\nÂàáÊèõÂæåÔºåË´ãÂëºÂè´Ë©≤È†ªÈÅìÁöÑÂèãËªçÂñÆ‰Ωç„ÄÇ', target_book: 'C' }, 
            'loc_9': { i: 'üçÄ', n: 'Âπ∏ÈÅãËçâ', c: 'N9T4', next: 'MISSION COMPLETE', comm: 'ÂõûÂ†± HQ ‰∏¶Á≠âÂÄôÊåáÁ§∫„ÄÇ', target_book: 'D' }, 
            
            // --- BRAVO SQUAD PATH ---
            'loc_2': { i: 'üçé', n: 'ËòãÊûú', c: 'X4T9', next: 'ÂâçÂæÄ LOC 7', comm: 'È†ªÈÅì‰∏çËÆä (Maintain Channel)„ÄÇ', target_book: 'A' }, 
            'loc_7': { i: 'üêª', n: 'ÁÜä', c: 'R3Z5', next: 'ÂâçÂæÄ LOC 10', comm: 'ÂàáÊèõËá≥ [‰∏ªÈ†ª CH2]„ÄÇ\nÂàáÊèõÂæåÔºåË´ãÂëºÂè´Ë©≤È†ªÈÅìÁöÑÂèãËªçÂñÆ‰Ωç„ÄÇ', target_book: 'D' }, 
            'loc_10': { i: 'üåµ', n: '‰ªô‰∫∫Êéå', c: 'J6K8', next: 'MISSION COMPLETE', comm: 'ÂõûÂ†± HQ ‰∏¶Á≠âÂÄôÊåáÁ§∫„ÄÇ', target_book: 'C' }, 

            // --- CHARLIE SQUAD PATH ---
            'loc_3': { i: 'ü•ù', n: 'Â•áÁï∞Êûú', c: 'J6H2', next: 'ÂâçÂæÄ LOC 6', comm: 'È†ªÈÅì‰∏çËÆä (Maintain Channel)„ÄÇ', target_book: 'D' }, 
            'loc_6': { i: 'ü¶Å', n: 'ÁçÖÂ≠ê', c: 'C7M1', next: 'ÂâçÂæÄ LOC 11', comm: 'È†ªÈÅì‰∏çËÆä (Maintain Channel)„ÄÇ', target_book: 'A' }, 
            'loc_11': { i: 'üå¥', n: 'Ê§∞Â≠êÊ®π', c: 'A2B6', next: 'MISSION COMPLETE', comm: 'ÂõûÂ†± HQ ‰∏¶Á≠âÂÄôÊåáÁ§∫„ÄÇ', target_book: 'B' }, 

            // --- DELTA SQUAD PATH ---
            'loc_4': { i: 'üçì', n: 'ËçâËéì', c: 'V1G5', next: 'ÂâçÂæÄ LOC 8', comm: 'ÂàáÊèõËá≥ [‰∏ªÈ†ª CH1]„ÄÇ\nÂàáÊèõÂæåÔºåË´ãÂëºÂè´Ë©≤È†ªÈÅìÁöÑÂèãËªçÂñÆ‰Ωç„ÄÇ', target_book: 'C' }, 
            'loc_8': { i: 'üêØ', n: 'ËÄÅËôé', c: 'Y5N8', next: 'ÂâçÂæÄ LOC 12', comm: 'È†ªÈÅì‰∏çËÆä (Maintain Channel)„ÄÇ', target_book: 'B' }, 
            'loc_12': { i: 'üå≤', n: 'ÊùæÊ®π', c: 'J3R6', next: 'MISSION COMPLETE', comm: 'ÂõûÂ†± HQ ‰∏¶Á≠âÂÄôÊåáÁ§∫„ÄÇ', target_book: 'A' }    
        };

        const teamColors = { 'A': 'var(--alpha)', 'B': 'var(--bravo)', 'C': 'var(--charlie)', 'D': 'var(--delta)' };
        const teamNames = { 'A': 'ALPHA SQUAD', 'B': 'BRAVO SQUAD', 'C': 'CHARLIE SQUAD', 'D': 'DELTA SQUAD' };

        // --- 3. STATE MANAGEMENT ---
        const urlParams = new URLSearchParams(window.location.search);
        const missionId = urlParams.get('id');
        let missionData = null;

        // --- 4. INITIALIZATION ---
        window.onload = function() {
            if (!missionId || !missions[missionId]) {
                showScreen('squad-menu');
            } else {
                missionData = missions[missionId];
                initMission();
            }
        };

        // --- 5. UI FUNCTIONS (ÂØÜÁ¢ºÊú¨ÈÇèËºØ) ---
        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(el => el.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
            window.scrollTo(0, 0); 
        }

        function showCodeBook(teamId) {
            const bookData = CODEBOOKS[teamId];
            const color = teamColors[teamId];
            const name = teamNames[teamId];
            const contentArea = document.getElementById('book-content-area');
            const header = document.getElementById('book-header');

            header.innerText = name + " BOOK";
            header.style.backgroundColor = color;

            contentArea.innerHTML = '';
            
            createCategoryGrid(contentArea, 'FRUITS / Ê∞¥Êûú', bookData.fruits, color);
            createCategoryGrid(contentArea, 'ANIMALS / ÂãïÁâ©', bookData.animals, color); 
            createCategoryGrid(contentArea, 'PLANTS / Ê§çÁâ©', bookData.plants, color); 

            showScreen('codebook-view');
        }

        function createCategoryGrid(container, title, items, color) {
            // Ê®ôÈ°å
            const titleDiv = document.createElement('div');
            titleDiv.className = 'book-category-title';
            titleDiv.innerText = title;
            container.appendChild(titleDiv);

            // Grid ÂÆπÂô®
            const gridDiv = document.createElement('div');
            gridDiv.className = 'book-grid';

            items.forEach((item) => {
                // Â∑¶ÂÅ¥ÔºöÂúñÁ§∫ + ÂêçÁ®±
                const itemCol = document.createElement('div');
                itemCol.className = 'book-item-col';
                itemCol.innerHTML = `<span class="book-icon">${item.i}</span><span>${item.n}</span>`;
                
                // Âè≥ÂÅ¥ÔºöÂØÜÁ¢º
                const codeCol = document.createElement('div');
                codeCol.className = 'book-code-col';
                codeCol.innerText = item.c; // Áõ¥Êé•È°ØÁ§∫Ë©≤Â∞èÈöäÁöÑÂ∞àÂ±¨ÂØÜÁ¢º
                codeCol.style.borderColor = color;
                codeCol.style.color = color;

                gridDiv.appendChild(itemCol);
                gridDiv.appendChild(codeCol);
            });

            container.appendChild(gridDiv);
        }

        // --- 6. MISSION LOGIC ---
        function initMission() {
            document.getElementById('target-display').innerText = missionData.i;
            document.getElementById('target-name').innerText = missionData.n;
            showScreen('screen-mission');
        }

        function verifyCode() {
            const inputEl = document.getElementById('mission-input');
            let rawInput = inputEl.value.toUpperCase();
            let cleanInput = rawInput.replace(/[^A-Z0-9]/g, ''); // ÁßªÈô§ÈÄ£Â≠óËôüÂíåÁ©∫ÁôΩ
            let fuzzyInput = cleanInput.replace(/0/g, 'O');
            let targetCode = missionData.c.replace(/0/g, 'O'); // Target ‰πüÊòØ‰πæÊ∑®ÁöÑ 4 Á¢º
            
            if (fuzzyInput === targetCode) {
                document.getElementById('success-next-loc').innerText = missionData.next;
                document.getElementById('success-comm-msg').innerText = missionData.comm;
                showScreen('screen-success');
            } else {
                shakeElement(inputEl);
                inputEl.value = '';
            }
        }

        function shakeElement(el) {
            el.style.transform = 'translateX(10px)';
            setTimeout(() => el.style.transform = 'translateX(-10px)', 50);
            setTimeout(() => el.style.transform = 'translateX(10px)', 100);
            setTimeout(() => el.style.transform = 'translateX(0)', 150);
            el.style.borderColor = 'red';
            setTimeout(() => el.style.borderColor = 'var(--highlight)', 500);
        }
    </script>
</body>
</html>
