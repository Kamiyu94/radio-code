<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>HQ MASTER CODEBOOK</title>
    <style>
        :root {
            --bg-color: #000000;
            --text-main: #ffffff;
            --text-dim: #aaaaaa;
            --panel-bg: #111111;
            --border-color: #333333;
            --highlight: #00ff41;
            
            /* Team Colors */
            --color-alpha: #ff3333;
            --color-bravo: #3388ff;
            --color-charlie: #00ff41;
            --color-delta: #ffff33;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            /* ç¦æ­¢é¸å–æ–‡å­—ï¼Œä½†å…è¨±åœ¨ç‰¹å®šå€åŸŸé¸å–(å¦‚è¼¸å…¥æ¡†) */
            user-select: none; 
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            /* ä½¿ç”¨ Consolas ç­‰å¯¬å­—é«”ï¼Œç¢ºä¿ 0 å’Œ O å®¹æ˜“è¾¨è­˜ (æ–œç·š0) */
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-variant-numeric: slashed-zero;
            margin: 0;
            padding: 0;
            /* ä½¿ç”¨ dvh è§£æ±ºæ‰‹æ©Ÿå·¥å…·åˆ—é®æ“‹å•é¡Œ */
            height: 100vh; 
            height: 100dvh; 
            width: 100vw;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .hidden { display: none !important; }
        
        button {
            font-family: inherit;
            border: none;
            outline: none;
            cursor: pointer;
            text-transform: uppercase;
            font-weight: bold;
        }

        input {
            font-family: inherit;
            user-select: text; /* å…è¨±è¼¸å…¥æ¡†é¸å– */
        }
        
        /* --- SCREEN 1: TEAM SELECT (HOME) --- */
        #screen-team-select {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            padding: 20px;
            padding-bottom: max(20px, env(safe-area-inset-bottom));
        }

        .home-header {
            flex: 0 0 auto;
            text-align: center;
            margin-bottom: 15px;
            margin-top: 10px;
        }

        .home-header h2 { margin: 0; font-size: 1.8rem; letter-spacing: 2px; text-shadow: 0 0 10px rgba(255,255,255,0.3); }
        .home-header p { margin: 5px 0 0 0; font-size: 0.9rem; opacity: 0.8; }

        .team-grid {
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 15px;
            min-height: 0;
            margin-bottom: 15px;
        }

        .team-btn {
            width: 100%; height: 100%; font-size: 1.5rem; border-radius: 12px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: #000; box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            border: 2px solid rgba(255,255,255,0.2);
        }
        .team-btn:active { transform: scale(0.98); }

        .btn-alpha { background-color: var(--color-alpha); }
        .btn-bravo { background-color: var(--color-bravo); }
        .btn-charlie { background-color: var(--color-charlie); }
        .btn-delta { background-color: var(--color-delta); }

        .gen-link-btn {
            flex: 0 0 50px;
            background: #222;
            border: 1px solid #444;
            color: #888;
            border-radius: 8px;
            font-size: 0.9rem;
            letter-spacing: 1px;
        }
        .gen-link-btn:active { background: #333; color: #fff; }

        /* --- SCREEN 2: MASTER CODEBOOK --- */
        #screen-master {
            height: 100%; width: 100%; display: flex; flex-direction: column; background: #000;
        }

        .master-header {
            flex: 0 0 60px; background: #1a1a1a; border-bottom: 2px solid var(--highlight);
            display: flex; justify-content: space-between; align-items: center; padding: 0 15px; z-index: 10;
        }

        #team-title { font-size: 1.4rem; font-weight: 900; color: var(--highlight); letter-spacing: 1px; }

        .action-btn {
            background: #333; color: #fff; padding: 8px 16px; border-radius: 4px; font-size: 0.9rem; border: 1px solid #555;
        }

        #grid-container {
            flex: 1; overflow-y: auto; padding: 15px; padding-bottom: 20px;
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; align-content: start;
        }

        .grid-item {
            background: #1a1a1a; border: 1px solid #444; border-radius: 8px; aspect-ratio: 1;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .grid-item:active { background: #333; }
        .grid-icon { font-size: 3rem; margin-bottom: 5px; }
        .grid-name { font-size: 0.9rem; color: #fff; font-weight: bold; text-align: center; width: 100%; overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }

        .bottom-nav {
            flex: 0 0 auto; width: 100%;
            height: calc(80px + env(safe-area-inset-bottom)); padding-bottom: env(safe-area-inset-bottom);
            background: #000; border-top: 1px solid #333; display: flex; z-index: 20;
        }
        .nav-btn {
            flex: 1; background: transparent; color: #666; font-size: 2rem;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .nav-btn.active { color: var(--highlight); background: rgba(255, 255, 255, 0.05); border-top: 3px solid var(--highlight); }
        .nav-label { font-size: 0.8rem; margin-top: 2px; color: #fff; }

        /* --- SCREEN 3: QR GENERATOR --- */
        #screen-generator {
            height: 100%; width: 100%; display: flex; flex-direction: column; background: #000;
        }
        
        .gen-content {
            flex: 1; overflow-y: auto; padding: 20px;
            padding-bottom: calc(50px + env(safe-area-inset-bottom));
        }

        .url-setup {
            background: #1a1a1a; border: 1px solid #444; padding: 15px; border-radius: 8px; margin-bottom: 20px;
        }
        .url-label { color: #888; font-size: 0.8rem; margin-bottom: 5px; display: block; }
        .url-input {
            width: 100%; background: #000; border: 1px solid #555; color: var(--highlight);
            padding: 10px; font-size: 1rem; border-radius: 4px; margin-bottom: 10px;
        }

        .phase-block { margin-bottom: 30px; border-top: 1px dashed #444; padding-top: 20px; }
        .phase-title { color: #fff; font-size: 1.2rem; font-weight: bold; margin-bottom: 5px; color: var(--highlight); }
        .rescue-info { color: var(--color-alpha); font-size: 0.9rem; margin-bottom: 15px; font-family: monospace; }

        .qr-item {
            display: flex; background: #111; border: 1px solid #333; margin-bottom: 15px; padding: 10px; border-radius: 8px; align-items: center;
        }
        .qr-img { width: 100px; height: 100px; background: #fff; margin-right: 15px; border-radius: 4px; }
        .qr-info { flex: 1; overflow: hidden; }
        .qr-desc { color: #fff; font-size: 1rem; font-weight: bold; margin-bottom: 5px; }
        .qr-sub { color: #888; font-size: 0.8rem; margin-bottom: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
        .copy-btn {
            background: #333; color: #fff; border: 1px solid #555; padding: 5px 10px; font-size: 0.8rem; border-radius: 4px;
        }
        .copy-btn:active { background: var(--highlight); color: #000; }

        /* MODAL */
        #modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center; z-index: 100;
        }
        .modal-content {
            background: #111; border: 2px solid var(--highlight); box-shadow: 0 0 30px var(--highlight);
            padding: 30px; width: 85%; max-width: 350px; border-radius: 16px; text-align: center;
            animation: zoomIn 0.2s ease-out;
        }
        @keyframes zoomIn { from {transform: scale(0.8); opacity: 0;} to {transform: scale(1); opacity: 1;} }
        #modal-icon { font-size: 5rem; display: block; margin-bottom: 10px; }
        #modal-name { font-size: 1.4rem; color: #fff; font-weight: bold; margin-bottom: 20px; display: block; }
        #modal-code {
            background: #000; color: var(--highlight); border: 2px dashed #444; font-size: 2.2rem;
            padding: 15px; border-radius: 8px; letter-spacing: 2px; font-weight: bold;
        }
        .modal-hint {
            margin-top: 20px; color: #fff; font-size: 0.9rem; font-weight: bold;
            border: 1px solid #555; padding: 5px; border-radius: 4px; display: inline-block; background: #222;
        }

    </style>
</head>
<body>

    <div id="screen-team-select">
        <div class="home-header">
            <h2>HQ MASTER LINK</h2>
            <p>SELECT TEAM CODEBOOK</p>
        </div>
        <div class="team-grid">
            <button class="team-btn btn-alpha" onclick="selectTeam('alpha')"><b>ALPHA</b></button>
            <button class="team-btn btn-bravo" onclick="selectTeam('bravo')"><b>BRAVO</b></button>
            <button class="team-btn btn-charlie" onclick="selectTeam('charlie')"><b>CHARLIE</b></button>
            <button class="team-btn btn-delta" onclick="selectTeam('delta')"><b>DELTA</b></button>
        </div>
        <button class="gen-link-btn" onclick="showGenerator()">[ GENERATE MISSION LINKS & QR ]</button>
    </div>

    <div id="screen-master" class="hidden">
        <div class="master-header">
            <span id="team-title">ALPHA TEAM</span>
            <button class="action-btn" onclick="exitToHome()">EXIT</button>
        </div>
        <div id="grid-container"></div>
        <div class="bottom-nav">
            <button class="nav-btn active" onclick="switchCategory('fruits')"><span>ğŸ</span><span class="nav-label">FRUITS</span></button>
            <button class="nav-btn" onclick="switchCategory('animals')"><span>ğŸ¦</span><span class="nav-label">ANIMALS</span></button>
            <button class="nav-btn" onclick="switchCategory('plants')"><span>ğŸŒ²</span><span class="nav-label">PLANTS</span></button>
        </div>
    </div>

    <div id="screen-generator" class="hidden">
        <div class="master-header" style="border-color:#666;">
            <span style="color:#fff;">MISSION LINKS</span>
            <button class="action-btn" onclick="exitToHome()">BACK</button>
        </div>
        <div class="gen-content">
            <div class="url-setup">
                <label class="url-label">BASE URL (mission.html ä½å€):</label>
                <input type="text" id="base-url" class="url-input" placeholder="https://your.github.io/mission.html" value="">
                <button class="action-btn" style="width:100%" onclick="updateQRCodes()">UPDATE QR CODES</button>
            </div>
            
            <div id="qr-list">
                </div>
        </div>
    </div>

    <div id="modal-overlay" class="hidden" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <span id="modal-icon">ğŸ</span>
            <span id="modal-name">è˜‹æœ</span>
            <div id="modal-code">X4T9</div>
            <div class="modal-hint" onclick="closeModal()">TAP TO CLOSE</div>
        </div>
    </div>

    <script>
        // --- DATABASE ---
        const db = {
            alpha: {
                fruits: [ {i:"ğŸ‡",n:"è‘¡è„",c:"L2Z5"}, {i:"ğŸ‰",n:"è¥¿ç“œ",c:"P8K3"}, {i:"ğŸŠ",n:"æ©˜å­",c:"S4M1"}, {i:"ğŸ‹",n:"æª¸æª¬",c:"T4W7"}, {i:"ğŸ",n:"è˜‹æœ",c:"X4T9"}, {i:"ğŸ‘",n:"æ¡ƒå­",c:"N8R3"}, {i:"ğŸ’",n:"æ«»æ¡ƒ",c:"E9I2"}, {i:"ğŸ",n:"æ¢¨å­",c:"Q4Y9"}, {i:"ğŸ¥¥",n:"æ¤°å­",c:"B1D6"}, {i:"ğŸ¥‘",n:"é…ªæ¢¨",c:"H5J0"}, {i:"ğŸ¬",n:"ç³–æœ",c:"F3G8"}, {i:"ğŸ¥­",n:"èŠ’æœ",c:"K7X1"}, {i:"ğŸˆ",n:"å“ˆå¯†ç“œ",c:"V2C5"}, {i:"ğŸ…",n:"ç•ªèŒ„",c:"O6A4"}, {i:"ğŸ“",n:"è‰è“",c:"U9E2"}, {i:"ğŸ",n:"é³³æ¢¨",c:"Z3N7"} ],
                animals: [ {i:"ğŸ¦…",n:"è€é·¹",c:"D5S2"}, {i:"ğŸ",n:"è›‡",c:"W9F0"}, {i:"ğŸ¦ˆ",n:"é¯Šé­š",c:"H1J3"}, {i:"ğŸ¦“",n:"æ–‘é¦¬",c:"O3A0"}, {i:"ğŸ³",n:"é¯¨é­š",c:"V2D6"}, {i:"ğŸ†",n:"çµè±¹",c:"K8B4"}, {i:"ğŸ¦",n:"ç…å­",c:"C7M1"}, {i:"ğŸ¦˜",n:"è¢‹é¼ ",c:"G6P9"}, {i:"ğŸŠ",n:"é±·é­š",c:"X2U5"}, {i:"ğŸ¦",n:"å¤§çŒ©çŒ©",c:"T1I8"}, {i:"ğŸ¦›",n:"æ²³é¦¬",c:"E4Z7"}, {i:"ğŸ¦’",n:"é•·é ¸é¹¿",c:"N3Y0"}, {i:"ğŸ¦‡",n:"è™è ",c:"Q5L2"}, {i:"ğŸ¦‰",n:"è²“é ­é·¹",c:"R9S6"}, {i:"ğŸª",n:"é§±é§",c:"M7H3"}, {i:"ğŸ¦š",n:"å­”é›€",c:"A0F1"} ],
                plants: [ {i:"ğŸŒ»",n:"å‘æ—¥è‘µ",c:"G2V4"}, {i:"ğŸŒµ",n:"ä»™äººæŒ",c:"B8H7"}, {i:"ğŸ‹",n:"ç«¹å­",c:"L6P2"}, {i:"ğŸ„",n:"è˜‘è‡",c:"S8M2"}, {i:"ğŸŒº",n:"æ‰¶æ¡‘èŠ±",c:"F5G8"}, {i:"ğŸŒ³",n:"æ©¡æ¨¹",c:"T1Q9"}, {i:"ğŸ",n:"æ¥“è‘‰",c:"Z7D5"}, {i:"ğŸ’",n:"è–°è¡£è‰",c:"K3I6"}, {i:"ğŸŒ¿",n:"è–„è·",c:"E2A4"}, {i:"ğŸŒ²",n:"æ¾æ¨¹",c:"J3R6"}, {i:"ğŸŒ¾",n:"å°éº¥",c:"Y9X1"}, {i:"ğŸŒ±",n:"è˜†è‘¦",c:"O5N0"}, {i:"ğŸ‚",n:"è½è‘‰",c:"H4W8"}, {i:"ğŸŒ¼",n:"é››èŠ",c:"C6U3"}, {i:"ğŸ¡",n:"æˆ¿å±‹",c:"V0S7"}, {i:"ğŸš",n:"è²æ®¼",c:"P8M5"} ]
            },
            bravo: {
                fruits: [ {i:"ğŸŒ",n:"é¦™è•‰",c:"A3O7"}, {i:"ğŸ",n:"é³³æ¢¨",c:"U6Q4"}, {i:"ğŸ",n:"æ¢¨å­",c:"B2H9"}, {i:"ğŸ",n:"è˜‹æœ",c:"C5K1"}, {i:"ğŸ‰",n:"è¥¿ç“œ",c:"D8M3"}, {i:"ğŸ¬",n:"ç³–æœ",c:"E0N6"}, {i:"ğŸ¥",n:"å¥‡ç•°æœ",c:"F4P2"}, {i:"ğŸ“",n:"è‰è“",c:"G7Q5"}, {i:"ğŸ¥¥",n:"æ¤°å­",c:"I1R8"}, {i:"ğŸ¥­",n:"èŠ’æœ",c:"J9S0"}, {i:"ğŸ‡",n:"è‘¡è„",c:"L3T6"}, {i:"ğŸ’",n:"æ«»æ¡ƒ",c:"V2X7"}, {i:"ğŸ‹",n:"æª¸æª¬",c:"W5Y3"}, {i:"ğŸŠ",n:"æ©˜å­",c:"Z8A4"}, {i:"ğŸ…",n:"ç•ªèŒ„",c:"B6C9"}, {i:"ğŸˆ",n:"å“ˆå¯†ç“œ",c:"D1E5"} ],
                animals: [ {i:"ğŸ¯",n:"è€è™",c:"Y5N8"}, {i:"ğŸ˜",n:"å¤§è±¡",c:"S2K9"}, {i:"ğŸ†",n:"çµè±¹",c:"F7G1"}, {i:"ğŸº",n:"ç‹¼",c:"H3I6"}, {i:"ğŸ»",n:"ç†Š",c:"J0L4"}, {i:"ğŸ¦Š",n:"ç‹ç‹¸",c:"M8O2"}, {i:"ğŸ¦",n:"ç…å­",c:"P5Q9"}, {i:"ğŸ¦“",n:"æ–‘é¦¬",c:"R1T7"}, {i:"ğŸ¦˜",n:"è¢‹é¼ ",c:"U4V0"}, {i:"ğŸ¦’",n:"é•·é ¸é¹¿",c:"W6X3"}, {i:"ğŸ¦ˆ",n:"é¯Šé­š",c:"Z9A5"}, {i:"ğŸ¦…",n:"è€é·¹",c:"B2C8"}, {i:"ğŸ¦‰",n:"è²“é ­é·¹",c:"D7E1"}, {i:"ğŸ",n:"è›‡",c:"F3G6"}, {i:"ğŸŠ",n:"é±·é­š",c:"H9I2"}, {i:"ğŸ¼",n:"ç†Šè²“",c:"K4L0"} ],
                plants: [ {i:"ğŸŒ¹",n:"ç«ç‘°",c:"M4X0"}, {i:"ğŸ",n:"æ¥“è‘‰",c:"Z7D5"}, {i:"ğŸŒ´",n:"æ¤°å­æ¨¹",c:"A2B6"}, {i:"ğŸ€",n:"å¹¸é‹è‰",c:"C9E1"}, {i:"ğŸŒ»",n:"å‘æ—¥è‘µ",c:"F3G8"}, {i:"ğŸŒµ",n:"ä»™äººæŒ",c:"H5I0"}, {i:"ğŸŒ·",n:"é¬±é‡‘é¦™",c:"J1K7"}, {i:"ğŸŒº",n:"æ‰¶æ¡‘èŠ±",c:"L6N3"}, {i:"ğŸŒ²",n:"æ¾æ¨¹",c:"O8P2"}, {i:"ğŸŒ¾",n:"ç¨»ç©—",c:"Q4R9"}, {i:"ğŸ„",n:"è˜‘è‡",c:"S0T5"}, {i:"ğŸ‹",n:"ç«¹å­",c:"U7V1"}, {i:"ğŸŒ¼",n:"é››èŠ",c:"W2Y6"}, {i:"ğŸ’",n:"è–°è¡£è‰",c:"Z5A3"}, {i:"ğŸŒ¿",n:"è–„è·",c:"B9C4"}, {i:"ğŸš",n:"è²æ®¼",c:"D1E8"} ]
            },
            charlie: {
                fruits: [ {i:"ğŸ“",n:"è‰è“",c:"V1G5"}, {i:"ğŸ‘",n:"æ¡ƒå­",c:"N8R3"}, {i:"ğŸ",n:"æ¢¨å­",c:"A4B7"}, {i:"ğŸ‹",n:"æª¸æª¬",c:"C9D1"}, {i:"ğŸ¥¥",n:"æ¤°å­",c:"E2F6"}, {i:"ğŸ‡",n:"è‘¡è„",c:"G5H0"}, {i:"ğŸˆ",n:"å“ˆå¯†ç“œ",c:"I8J3"}, {i:"ğŸ‰",n:"è¥¿ç“œ",c:"K1L9"}, {i:"ğŸŠ",n:"æ©˜å­",c:"M6N4"}, {i:"ğŸ",n:"é³³æ¢¨",c:"O3P7"}, {i:"ğŸ",n:"è˜‹æœ",c:"Q0R2"}, {i:"ğŸŒ",n:"é¦™è•‰",c:"S5T8"}, {i:"ğŸ¥­",n:"èŠ’æœ",c:"U7V9"}, {i:"ğŸ…",n:"ç•ªèŒ„",c:"W2X5"}, {i:"ğŸ¬",n:"ç³–æœ",c:"Y6Z1"}, {i:"ğŸ¥‘",n:"é…ªæ¢¨",c:"A9B4"} ],
                animals: [ {i:"ğŸº",n:"ç‹¼",c:"F6B2"}, {i:"ğŸ¼",n:"ç†Šè²“",c:"I9E4"}, {i:"ğŸ¦",n:"ç…å­",c:"C2D8"}, {i:"ğŸ…",n:"è€è™",c:"G7H1"}, {i:"ğŸ¦“",n:"æ–‘é¦¬",c:"J3K5"}, {i:"ğŸ¦…",n:"è€é·¹",c:"L0M9"}, {i:"ğŸŠ",n:"é±·é­š",c:"N4O6"}, {i:"ğŸ¦ˆ",n:"é¯Šé­š",c:"P8Q2"}, {i:"ğŸ˜",n:"å¤§è±¡",c:"R1S7"}, {i:"ğŸ¦‰",n:"è²“é ­é·¹",c:"T5U0"}, {i:"ğŸ¦’",n:"é•·é ¸é¹¿",c:"V9W3"}, {i:"ğŸ¦›",n:"æ²³é¦¬",c:"X6Y1"}, {i:"ğŸ¦",n:"å¤§çŒ©çŒ©",c:"Z2A8"}, {i:"ğŸ¦Š",n:"ç‹ç‹¸",c:"B7C3"}, {i:"ğŸ¦˜",n:"è¢‹é¼ ",c:"D0E5"}, {i:"ğŸ»",n:"ç†Š",c:"F4G9"} ],
                plants: [ {i:"ğŸŒ·",n:"é¬±é‡‘é¦™",c:"Q7U1"}, {i:"ğŸŒ´",n:"æ¤°å­æ¨¹",c:"C5Y9"}, {i:"ğŸ„",n:"è˜‘è‡",c:"S8M2"}, {i:"ğŸ‹",n:"ç«¹å­",c:"A3B6"}, {i:"ğŸ",n:"æ¥“è‘‰",c:"D0E4"}, {i:"ğŸŒ²",n:"æ¾æ¨¹",c:"F9G2"}, {i:"ğŸŒº",n:"æ‰¶æ¡‘èŠ±",c:"H1I5"}, {i:"ğŸŒµ",n:"ä»™äººæŒ",c:"J6K8"}, {i:"ğŸŒ»",n:"å‘æ—¥è‘µ",c:"L2M7"}, {i:"ğŸŒ¹",n:"ç«ç‘°",c:"N4O0"}, {i:"ğŸ€",n:"å¹¸é‹è‰",c:"P8R3"}, {i:"ğŸŒ¾",n:"ç¨»ç©—",c:"S5T9"}, {i:"ğŸ’",n:"è–°è¡£è‰",c:"V1W6"}, {i:"ğŸŒ¼",n:"é››èŠ",c:"X7Z2"}, {i:"ğŸŒ¿",n:"è–„è·",c:"A9B3"}, {i:"ğŸš",n:"è²æ®¼",c:"C0D5"} ]
            },
            delta: {
                fruits: [ {i:"ğŸ¥",n:"å¥‡ç•°æœ",c:"J6H2"}, {i:"ğŸ",n:"æ¢¨å­",c:"Q4Y9"}, {i:"ğŸ¥­",n:"èŠ’æœ",c:"K7X1"}, {i:"ğŸŒ",n:"é¦™è•‰",c:"A2B5"}, {i:"ğŸ",n:"è˜‹æœ",c:"C8D0"}, {i:"ğŸ’",n:"æ«»æ¡ƒ",c:"E3F9"}, {i:"ğŸ‡",n:"è‘¡è„",c:"G6I4"}, {i:"ğŸ‰",n:"è¥¿ç“œ",c:"L1M7"}, {i:"ğŸ“",n:"è‰è“",c:"N5O2"}, {i:"ğŸ‹",n:"æª¸æª¬",c:"P9R3"}, {i:"ğŸ",n:"é³³æ¢¨",c:"S4T8"}, {i:"ğŸˆ",n:"å“ˆå¯†ç“œ",c:"U0V6"}, {i:"ğŸŠ",n:"æ©˜å­",c:"W7Z1"}, {i:"ğŸ¥‘",n:"é…ªæ¢¨",c:"A5B9"}, {i:"ğŸ¥¥",n:"æ¤°å­",c:"C2D6"}, {i:"ğŸ…",n:"ç•ªèŒ„",c:"E8F3"} ],
                animals: [ {i:"ğŸ»",n:"ç†Š",c:"R3Z5"}, {i:"ğŸ¦Š",n:"ç‹ç‹¸",c:"L8P0"}, {i:"ğŸ³",n:"é¯¨é­š",c:"V2D6"}, {i:"ğŸ…",n:"è€è™",c:"A7B1"}, {i:"ğŸ¦",n:"ç…å­",c:"C9E4"}, {i:"ğŸº",n:"ç‹¼",c:"F5G8"}, {i:"ğŸ˜",n:"å¤§è±¡",c:"H2I6"}, {i:"ğŸ¦",n:"å¤§çŒ©çŒ©",c:"J0K3"}, {i:"ğŸŠ",n:"é±·é­š",c:"M4N9"}, {i:"ğŸ†",n:"çµè±¹",c:"O6Q2"}, {i:"ğŸ¦’",n:"é•·é ¸é¹¿",c:"S1T7"}, {i:"ğŸ¦…",n:"è€é·¹",c:"U8V3"}, {i:"ğŸ¦‰",n:"è²“é ­é·¹",c:"W5X0"}, {i:"ğŸ¦‡",n:"è™è ",c:"Y9Z4"}, {i:"ğŸ¦›",n:"æ²³é¦¬",c:"A3B8"}, {i:"ğŸ¦˜",n:"è¢‹é¼ ",c:"C6D2"} ],
                plants: [ {i:"ğŸ€",n:"å¹¸é‹è‰",c:"N9T4"}, {i:"ğŸŒ¾",n:"ç¨»ç©—",c:"W1E3"}, {i:"ğŸŒº",n:"æ‰¶æ¡‘èŠ±",c:"F5G8"}, {i:"ğŸŒ¹",n:"ç«ç‘°",c:"H2I7"}, {i:"ğŸŒ·",n:"é¬±é‡‘é¦™",c:"J6K0"}, {i:"ğŸŒ²",n:"æ¾æ¨¹",c:"L4M9"}, {i:"ğŸŒ»",n:"å‘æ—¥è‘µ",c:"O3P5"}, {i:"ğŸŒµ",n:"ä»™äººæŒ",c:"Q8R1"}, {i:"ğŸ‹",n:"ç«¹å­",c:"S2T6"}, {i:"ğŸ",n:"æ¥“è‘‰",c:"U7V4"}, {i:"ğŸŒ´",n:"æ¤°å­æ¨¹",c:"X0Y5"}, {i:"ğŸ’",n:"è–°è¡£è‰",c:"Z9A3"}, {i:"ğŸŒ¼",n:"é››èŠ",c:"B8C2"}, {i:"ğŸŒ¿",n:"è–„è·",c:"D1E6"}, {i:"ğŸš",n:"è²æ®¼",c:"F5G0"}, {i:"ğŸ¡",n:"æˆ¿å±‹",c:"H4I9"} ]
            }
        };

        // --- APP STATE ---
        let currentTeam = null;
        let currentCat = 'fruits';

        // --- ELEMENTS ---
        const screenSelect = document.getElementById('screen-team-select');
        const screenMaster = document.getElementById('screen-master');
        const screenGen = document.getElementById('screen-generator');
        const gridContainer = document.getElementById('grid-container');
        const teamTitle = document.getElementById('team-title');
        const modal = document.getElementById('modal-overlay');
        const navBtns = document.querySelectorAll('.nav-btn');

        // --- CORE FUNCTIONS ---

        function selectTeam(team) {
            currentTeam = team;
            teamTitle.innerText = team.toUpperCase() + " TEAM";
            
            let color = '#00ff41';
            if(team === 'alpha') color = '#ff3333';
            if(team === 'bravo') color = '#3388ff';
            if(team === 'charlie') color = '#00ff41';
            if(team === 'delta') color = '#ffff33';
            
            document.documentElement.style.setProperty('--highlight', color);
            
            screenSelect.classList.add('hidden');
            screenMaster.classList.remove('hidden');
            
            switchCategory('fruits');
        }

        function exitToHome() {
            screenMaster.classList.add('hidden');
            screenGen.classList.add('hidden');
            screenSelect.classList.remove('hidden');
            currentTeam = null;
        }

        function switchCategory(cat) {
            currentCat = cat;
            navBtns.forEach(btn => {
                if(btn.innerText.toLowerCase().includes(cat)) btn.classList.add('active');
                else btn.classList.remove('active');
            });
            renderGrid();
        }

        function renderGrid() {
            gridContainer.innerHTML = '';
            const items = db[currentTeam][currentCat];
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'grid-item';
                div.onclick = () => showModal(item);
                div.innerHTML = `<div class="grid-icon">${item.i}</div><div class="grid-name">${item.n}</div>`;
                gridContainer.appendChild(div);
            });
        }

        function showModal(item) {
            document.getElementById('modal-icon').innerText = item.i;
            document.getElementById('modal-name').innerText = item.n;
            document.getElementById('modal-code').innerText = item.c;
            modal.classList.remove('hidden');
        }

        function closeModal() {
            modal.classList.add('hidden');
        }

        // --- GENERATOR FUNCTIONS ---

        const missionPoints = [
            { title: "PHASE 1: FRUITS (Rescue: 7xxx)", points: [
                { id: 'loc_1', desc: '1. Açµ„åœ°é» (çœ‹é¦™è•‰/Bravoçµ¦)', icon: 'ğŸŒ' },
                { id: 'loc_2', desc: '2. Bçµ„åœ°é» (çœ‹è˜‹æœ/Alphaçµ¦)', icon: 'ğŸ' },
                { id: 'loc_3', desc: '3. Cçµ„åœ°é» (çœ‹å¥‡ç•°æœ/Deltaçµ¦)', icon: 'ğŸ¥' },
                { id: 'loc_4', desc: '4. Dçµ„åœ°é» (çœ‹è‰è“/Charlieçµ¦)', icon: 'ğŸ“' }
            ]},
            { title: "PHASE 2: ANIMALS (Rescue: 8xxx)", points: [
                { id: 'loc_5', desc: '5. Açµ„åœ°é» (çœ‹ç‹¼/Charlieçµ¦)', icon: 'ğŸº' },
                { id: 'loc_6', desc: '6. Cçµ„åœ°é» (çœ‹ç…å­/Alphaçµ¦)', icon: 'ğŸ¦' },
                { id: 'loc_7', desc: '7. Bçµ„åœ°é» (çœ‹ç†Š/Deltaçµ¦)', icon: 'ğŸ»' },
                { id: 'loc_8', desc: '8. Dçµ„åœ°é» (çœ‹è€è™/Bravoçµ¦)', icon: 'ğŸ¯' }
            ]},
            { title: "PHASE 3: PLANTS (Rescue: 9xxx)", points: [
                { id: 'hq_a', desc: 'HQ-Açµ„ (çœ‹å¹¸é‹è‰/Deltaçµ¦)', icon: 'ğŸ€' },
                { id: 'hq_b', desc: 'HQ-Bçµ„ (çœ‹é¬±é‡‘é¦™/Charlieçµ¦)', icon: 'ğŸŒ·' },
                { id: 'hq_c', desc: 'HQ-Cçµ„ (çœ‹ç«ç‘°/Bravoçµ¦)', icon: 'ğŸŒ¹' },
                { id: 'hq_d', desc: 'HQ-Dçµ„ (çœ‹æ¾æ¨¹/Alphaçµ¦)', icon: 'ğŸŒ²' }
            ]}
        ];

        function showGenerator() {
            screenSelect.classList.add('hidden');
            screenGen.classList.remove('hidden');
            
            // Load saved URL
            const savedUrl = localStorage.getItem('base_mission_url');
            if(savedUrl) document.getElementById('base-url').value = savedUrl;
            
            updateQRCodes();
        }

        function updateQRCodes() {
            const baseUrl = document.getElementById('base-url').value.trim();
            const listContainer = document.getElementById('qr-list');
            
            if(baseUrl) localStorage.setItem('base_mission_url', baseUrl);
            
            listContainer.innerHTML = '';

            if(!baseUrl) {
                listContainer.innerHTML = '<div style="color:#888; text-align:center; padding:20px;">PLEASE ENTER BASE URL FIRST</div>';
                return;
            }

            missionPoints.forEach(phase => {
                const phaseDiv = document.createElement('div');
                phaseDiv.className = 'phase-block';
                phaseDiv.innerHTML = `<div class="phase-title">${phase.title}</div>`;
                
                phase.points.forEach(p => {
                    const fullUrl = `${baseUrl}?id=${p.id}`;
                    // Using QR Server API for generation
                    const qrSrc = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(fullUrl)}`;
                    
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'qr-item';
                    itemDiv.innerHTML = `
                        <img src="${qrSrc}" class="qr-img" alt="QR">
                        <div class="qr-info">
                            <div class="qr-desc">${p.icon} ${p.desc}</div>
                            <div class="qr-sub">${fullUrl}</div>
                            <button class="copy-btn" onclick="copyToClipboard('${fullUrl}')">COPY LINK</button>
                        </div>
                    `;
                    phaseDiv.appendChild(itemDiv);
                });
                
                listContainer.appendChild(phaseDiv);
            });
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('LINK COPIED!');
            }).catch(err => {
                console.error('Copy failed', err);
            });
        }

    </script>
</body>
</html>
